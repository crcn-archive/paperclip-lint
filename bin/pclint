#!/usr/bin/env node
var argv = require("optimist").
usage("Usage: $0 [template-path]").
argv;

require("colors");


var pclint = require(".."),
pc         = require("paperclip"),
fs         = require("fs"),
src,

report = pclint(pc.compile(fs.readFileSync(src = argv._.shift(), "utf8")));

function printProblems (label, collection) {
  if (!collection.length) return;
  console.log("\n%s %d\n", label, collection.length);
  for(var i = collection.length; i--;) {
    console.error(" - " + collection[i].message);
  }
  console.log("");
}

printProblems("Warnings:", report.warnings);
printProblems("Errors:", report.errors);

if (!report.errors.length && !report.warnings.length) {
  console.log("lint free!");
}

if(report.errors.length) {
  process.exit(1);
}
